(()=>{"use strict";var e={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_disabled",inputErrorClass:"popup__span-error_active",errorClass:"popup__error_visible"},t=document.querySelector(".profile__edit-button"),n=document.querySelector(".profile__add-button");function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._container=document.querySelector(n),this._renderer=o}var t,n;return t=e,(n=[{key:"renderItems",value:function(){var e=this;this._items.forEach((function(t){return e._renderer(t)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t.name,this._url=t.url,this._templateSelector=n,this._handleCardClick=r}var t,n;return t=e,(n=[{key:"_getTemplate",value:function(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}},{key:"_deleteCard",value:function(){this._element.remove(),this._element=null}},{key:"_handleLikeCard",value:function(){this._likeButton.classList.toggle("element__heart_active")}},{key:"_setEventListeners",value:function(){var e=this;this._elementImage=this._element.querySelector(".element__image"),this._likeButton=this._element.querySelector(".element__heart"),this._element.querySelector(".element__trash-bin").addEventListener("click",(function(){e._deleteCard()})),this._likeButton.addEventListener("click",(function(){e._handleLikeCard()})),this._elementImage.addEventListener("click",(function(){e._handleCardClick({name:e._name,url:e._url})}))}},{key:"generateCard",value:function(){return this._element=this._getTemplate(),this._setEventListeners(),this._elementImage.src=this._url,this._elementImage.alt=this._name,this._element.querySelector(".element__name").textContent=this._name,this._element}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._validationObject=t,this._formElement=n,this._inputList=Array.from(this._formElement.querySelectorAll(this._validationObject.inputSelector))}var t,n;return t=e,(n=[{key:"_hasInvalidInput",value:function(){return this._inputList.some((function(e){return!e.validity.valid}))}},{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._validationObject.inputErrorClass),n.classList.add(this._validationObject.errorClass),n.textContent=t}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._validationObject.inputErrorClass),t.textContent="",t.classList.remove(this._validationObject.errorClass)}},{key:"_toggleInputError",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput()?this.disableButton():this._enableButton()}},{key:"_setEventListeners",value:function(){var e=this;this._buttonElement=this._formElement.querySelector(this._validationObject.submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._toggleInputError(t),e._toggleButtonState()}))}))}},{key:"disableButton",value:function(){this._buttonElement.classList.add(this._validationObject.inactiveButtonClass),this._buttonElement.disabled=!0}},{key:"_enableButton",value:function(){this._buttonElement.classList.remove(this._validationObject.inactiveButtonClass),this._buttonElement.disabled=!1}},{key:"enableValidation",value:function(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}},{key:"resetValidation",value:function(){var e=this;this._inputList.forEach((function(t){e._hideInputError(t),e.disableButton()}))}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupElement=document.querySelector(t),this._handleKeydownEvent=this._handleKeydownEvent.bind(this)}var t,n;return t=e,(n=[{key:"_handleKeydownEvent",value:function(e){"Escape"===e.key&&this.closePopup()}},{key:"openPopup",value:function(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keydown",this._handleKeydownEvent)}},{key:"closePopup",value:function(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleKeydownEvent)}},{key:"setEventListeners",value:function(){var e=this;this._popupElement.addEventListener("click",(function(t){(t.target.classList.contains("popup_opened")||t.target.classList.contains("popup__close"))&&e.closePopup()}))}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(){return d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=y(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},d.apply(this,arguments)}function y(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function m(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_(r);if(o){var n=_(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._elementImage=t._popupElement.querySelector(".popup-image__content"),t._elementCaption=t._popupElement.querySelector(".popup-image__caption"),t}return t=a,(n=[{key:"openPopup",value:function(e){var t=e.name,n=e.url;d(_(a.prototype),"openPopup",this).call(this),this._elementImage.src=n,this._elementImage.alt=t,this._elementCaption.textContent=t}}])&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=w(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},E.apply(this,arguments)}function w(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}function k(e,t){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},k(e,t)}function O(e,t){if(t&&("object"===b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=j(r);if(o){var n=j(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return O(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=i.call(this,e))._handleFormSubmit=t,n._inputForm=n._popupElement.querySelector(".popup__form"),n._inputList=n._inputForm.querySelectorAll(".popup__input"),n}return t=a,(n=[{key:"_getInputValues",value:function(){var e={};return this._inputList.forEach((function(t){e[t.name]=t.value})),e}},{key:"setInputValues",value:function(e){this._inputList.forEach((function(t){t.value=e[t.name]}))}},{key:"setEventListeners",value:function(){var e=this;E(j(a.prototype),"setEventListeners",this).call(this),this._inputForm.addEventListener("submit",(function(){e._handleFormSubmit(e._getInputValues()),e.closePopup()}))}},{key:"closePopup",value:function(){E(j(a.prototype),"closePopup",this).call(this),this._inputForm.reset()}}])&&g(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s);function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var L=new(function(){function e(t){var n=t.nameSelector,r=t.bioSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=document.querySelector(n),this._bio=document.querySelector(r)}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this._name.textContent,bio:this._bio.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.bio;this._name.textContent=t,this._bio.textContent=n}}])&&P(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}())({nameSelector:".profile__name",bioSelector:".profile__bio"}),C=new v(".popup-image"),I=new S(".add-popup",(function(e){T.addItem(R(e))}));I.setEventListeners();var x=new l(e,I._inputForm);x.enableValidation();var B=new S(".profile-popup",(function(e){var t=e.name,n=e.bio;L.setUserInfo({name:t,bio:n})}));B.setEventListeners();var q=new l(e,B._inputForm);function R(e){var t=e.name,n=e.url;return new a({name:t,url:n},".template",C.openPopup.bind(C)).generateCard()}q.enableValidation();var T=new o({items:[{name:"Архыз",url:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",url:"https://images.unsplash.com/photo-1575737906030-725233b5c103?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2072&q=80"},{name:"Иваново",url:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",url:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",url:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",url:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:function(e){return T.addItem(R(e))}},".elements");T.renderItems(),n.addEventListener("click",(function(){x.disableButton(),I.openPopup()})),t.addEventListener("click",(function(){var e=L.getUserInfo();B.setInputValues(e),B.openPopup(),q.resetValidation()})),C.setEventListeners()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBZU0sbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0b195YW5kZXgvLi9zcmMvY29tcG9uZW50cy91dGlscy5qcyIsIndlYnBhY2s6Ly9tZXN0b195YW5kZXgvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL21lc3RvX3lhbmRleC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG9feWFuZGV4Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9tZXN0b195YW5kZXgvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9tZXN0b195YW5kZXgvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9tZXN0b195YW5kZXgvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvX3lhbmRleC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9tZXN0b195YW5kZXgvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB2YWxpZGF0aW9uT2JqZWN0ID0ge1xuICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxuICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19zYXZlLWJ1dHRvbicsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fc2F2ZS1idXR0b25fZGlzYWJsZWQnLFxuICBpbnB1dEVycm9yQ2xhc3M6ICdwb3B1cF9fc3Bhbi1lcnJvcl9hY3RpdmUnLFxuICBlcnJvckNsYXNzOiAncG9wdXBfX2Vycm9yX3Zpc2libGUnXG59XG5cbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6ICfQkNGA0YXRi9C3JyxcbiAgICB1cmw6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQvYXJraHl6LmpwZydcbiAgfSxcbiAge1xuICAgIG5hbWU6ICfQp9C10LvRj9Cx0LjQvdGB0LrQsNGPINC+0LHQu9Cw0YHRgtGMJyxcbiAgICB1cmw6ICdodHRwczovL2ltYWdlcy51bnNwbGFzaC5jb20vcGhvdG8tMTU3NTczNzkwNjAzMC03MjUyMzNiNWMxMDM/aXhsaWI9cmItMS4yLjEmaXhpZD1Nbnd4TWpBM2ZEQjhNSHh3YUc5MGJ5MXdZV2RsZkh4OGZHVnVmREI4Zkh4OCZhdXRvPWZvcm1hdCZmaXQ9Y3JvcCZ3PTIwNzImcT04MCdcbiAgfSxcbiAge1xuICAgIG5hbWU6ICfQmNCy0LDQvdC+0LLQvicsXG4gICAgdXJsOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2l2YW5vdm8uanBnJ1xuICB9LFxuICB7XG4gICAgbmFtZTogJ9Ca0LDQvNGH0LDRgtC60LAnLFxuICAgIHVybDogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9rYW1jaGF0a2EuanBnJ1xuICB9LFxuICB7XG4gICAgbmFtZTogJ9Cl0L7Qu9C80L7Qs9C+0YDRgdC60LjQuSDRgNCw0LnQvtC9JyxcbiAgICB1cmw6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQva2hvbG1vZ29yc2t5LXJheW9uLmpwZydcbiAgfSxcbiAge1xuICAgIG5hbWU6ICfQkdCw0LnQutCw0LsnLFxuICAgIHVybDogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9iYWlrYWwuanBnJ1xuICB9XG5dO1xuXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xuY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XG5cbmV4cG9ydCB7IHZhbGlkYXRpb25PYmplY3QsIGluaXRpYWxDYXJkcywgcHJvZmlsZUFkZEJ1dHRvbiwgcHJvZmlsZUVkaXRCdXR0b259XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IgKCB7aXRlbXMsIHJlbmRlcmVyfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gIH1cblxuICByZW5kZXJJdGVtcyAoKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaChpdGVtID0+IHRoaXMuX3JlbmRlcmVyKGl0ZW0pKTtcbiAgfVxuXG4gIGFkZEl0ZW0gKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yIChjb25maWcsIHRlbXBsYXRlLCBoYW5kbGVDYXJkQ2xpY2spIHtcbiAgICB0aGlzLl9uYW1lID0gY29uZmlnLm5hbWU7XG4gICAgdGhpcy5fdXJsID0gY29uZmlnLnVybDtcbiAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGU7XG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlICgpIHtcbiAgICBjb25zdCB0ZW1wbGF0ZUVsZW1lbnQgPSBkb2N1bWVudFxuICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IpXG4gICAgLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcignLmVsZW1lbnQnKVxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICByZXR1cm4gdGVtcGxhdGVFbGVtZW50O1xuICB9XG5cbiAgX2RlbGV0ZUNhcmQgKCkge1xuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBfaGFuZGxlTGlrZUNhcmQgKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnZWxlbWVudF9faGVhcnRfYWN0aXZlJyk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgKCkge1xuICAgIHRoaXMuX2VsZW1lbnRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2ltYWdlJyk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2hlYXJ0Jyk7XG5cbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X190cmFzaC1iaW4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIHRoaXMuX2RlbGV0ZUNhcmQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCgpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fZWxlbWVudEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHtuYW1lOiB0aGlzLl9uYW1lLCB1cmw6IHRoaXMuX3VybH0pO1xuICAgIH0pXG4gIH1cblxuICBnZW5lcmF0ZUNhcmQgKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fZWxlbWVudEltYWdlLnNyYyA9IHRoaXMuX3VybDtcbiAgICB0aGlzLl9lbGVtZW50SW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19uYW1lJykudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IodmFsaWRhdGlvbk9iamVjdCwgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl92YWxpZGF0aW9uT2JqZWN0ID0gdmFsaWRhdGlvbk9iamVjdDtcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl92YWxpZGF0aW9uT2JqZWN0LmlucHV0U2VsZWN0b3IpKTtcbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQgKCkge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoZm9ybUlucHV0KSA9PiB7XG4gICAgICByZXR1cm4gIWZvcm1JbnB1dC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfTtcblxuICBfc2hvd0lucHV0RXJyb3IgKGZvcm1JbnB1dCwgZXJyb3JNZXNzYWdlKSAge1xuICAgIGNvbnN0IGZvcm1FcnJvciA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2Zvcm1JbnB1dC5pZH0tZXJyb3JgKTtcbiAgICBmb3JtSW5wdXQuY2xhc3NMaXN0LmFkZCh0aGlzLl92YWxpZGF0aW9uT2JqZWN0LmlucHV0RXJyb3JDbGFzcyk7XG4gICAgZm9ybUVycm9yLmNsYXNzTGlzdC5hZGQodGhpcy5fdmFsaWRhdGlvbk9iamVjdC5lcnJvckNsYXNzKTtcbiAgICBmb3JtRXJyb3IudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gIH07XG5cbiAgX2hpZGVJbnB1dEVycm9yIChmb3JtSW5wdXQpIHtcbiAgICBjb25zdCBmb3JtRXJyb3IgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtmb3JtSW5wdXQuaWR9LWVycm9yYCk7XG4gICAgZm9ybUlucHV0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fdmFsaWRhdGlvbk9iamVjdC5pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGZvcm1FcnJvci50ZXh0Q29udGVudCA9ICcnO1xuICAgIGZvcm1FcnJvci5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3ZhbGlkYXRpb25PYmplY3QuZXJyb3JDbGFzcyk7XG4gIH07XG5cbiAgX3RvZ2dsZUlucHV0RXJyb3IgKGZvcm1JbnB1dCkge1xuICAgIGlmICghZm9ybUlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihmb3JtSW5wdXQsIGZvcm1JbnB1dC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGZvcm1JbnB1dCk7XG4gICAgfVxuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlICgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMgKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3ZhbGlkYXRpb25PYmplY3Quc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGZvcm1JbnB1dCkgPT4ge1xuICAgICAgZm9ybUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xuICAgICAgICB0aGlzLl90b2dnbGVJbnB1dEVycm9yKGZvcm1JbnB1dCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICBkaXNhYmxlQnV0dG9uICgpIHtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fdmFsaWRhdGlvbk9iamVjdC5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIF9lbmFibGVCdXR0b24gKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl92YWxpZGF0aW9uT2JqZWN0LmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24gKCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGV2dCA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9O1xuXG4gIHJlc2V0VmFsaWRhdGlvbiAoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgfSlcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3RvciAocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlS2V5ZG93bkV2ZW50ID0gdGhpcy5faGFuZGxlS2V5ZG93bkV2ZW50LmJpbmQodGhpcyk7XG4gIH1cblxuICBfaGFuZGxlS2V5ZG93bkV2ZW50IChldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgIHRoaXMuY2xvc2VQb3B1cCgpO1xuICAgIH1cbiAgfVxuXG4gIG9wZW5Qb3B1cCAoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3BvcHVwX29wZW5lZCcpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVLZXlkb3duRXZlbnQpO1xuICB9XG5cbiAgY2xvc2VQb3B1cCAoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUtleWRvd25FdmVudCk7XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMgKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+IHtcbiAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfb3BlbmVkJykgfHwgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UnKSkpIHtcbiAgICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XG4gICAgICB9XG4gICAgfSlcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3RvciAocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2VsZW1lbnRJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtaW1hZ2VfX2NvbnRlbnQnKTtcbiAgICB0aGlzLl9lbGVtZW50Q2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtaW1hZ2VfX2NhcHRpb24nKTtcbiAgfVxuXG4gIG9wZW5Qb3B1cCh7bmFtZSwgdXJsfSkge1xuICAgIHN1cGVyLm9wZW5Qb3B1cCgpO1xuICAgIHRoaXMuX2VsZW1lbnRJbWFnZS5zcmMgPSB1cmw7XG4gICAgdGhpcy5fZWxlbWVudEltYWdlLmFsdCA9IG5hbWU7XG4gICAgdGhpcy5fZWxlbWVudENhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICB9XG5cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3RvciAocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2lucHV0Rm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9pbnB1dEZvcm0ucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19pbnB1dCcpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzICgpIHtcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSlcblxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldElucHV0VmFsdWVzIChpdGVtcykge1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICAgIGlucHV0LnZhbHVlID0gaXRlbXNbaW5wdXQubmFtZV07XG4gICAgfSlcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzICgpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2lucHV0Rm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5jbG9zZVBvcHVwKCk7XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZVBvcHVwICgpIHtcbiAgICBzdXBlci5jbG9zZVBvcHVwKCk7XG4gICAgdGhpcy5faW5wdXRGb3JtLnJlc2V0KCk7XG4gIH1cbn1cbiIsImltcG9ydCB7IHZhbGlkYXRpb25PYmplY3QsIGluaXRpYWxDYXJkcywgcHJvZmlsZUFkZEJ1dHRvbiwgcHJvZmlsZUVkaXRCdXR0b259IGZyb20gJy4uL2NvbXBvbmVudHMvdXRpbHMuanMnO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSAnLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzJztcbmltcG9ydCBDYXJkIGZyb20gJy4uL2NvbXBvbmVudHMvQ2FyZC5qcyc7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tICcuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMnO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMnO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzJztcbmltcG9ydCBVc2VySW5mbyBmcm9tICcuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzJztcbmltcG9ydCAnLi9pbmRleC5jc3MnO1xuLy8g0JTQu9GPINGA0LXQstGM0Y46INC80L3QvtCz0LjQtSDQvtGI0LjQsdC60LgsINC90LDQv9GA0LjQvNC10YAg0L/QtdGA0LXQvdC+0YEg0L/QtdGA0LXQvNC10L3QvdGL0YUg0LIgdXRpbHMuanMg0Y8g0YHQtNC10LvQsNC7INC4INC30LDQu9C40Lsg0L3QsCDQs9C40YLRhdCw0LFcbi8vINC90L4g0L3QsCDRgNC10LLRjNGOINC+0YLQv9GA0LDQstC40LvQsNGB0Ywg0L/RgNC10LTRi9C00YPRidCw0Y8g0LLQtdGA0YHQuNGPINGA0LDQsdC+0YLRiywg0LPQtNC1INGN0YLQuCDQvtGI0LjQsdC60Lgg0LXRidC1INC90LUg0LHRi9C70Lgg0LjRgdC/0YDQsNCy0LvQtdC90Ytcbi8vINCe0LPRgNC+0LzQvdC+0LUg0YHQv9Cw0YHQuNCx0L4g0LfQsCDQv9C+0LTRgNC+0LHQvdGL0LUg0LrQvtC80LzQtdC90YLQsNGA0LjQuCFcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtuYW1lU2VsZWN0b3I6ICcucHJvZmlsZV9fbmFtZScsIGJpb1NlbGVjdG9yOicucHJvZmlsZV9fYmlvJ30pO1xuXG5jb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZSgnLnBvcHVwLWltYWdlJyk7XG5cbmNvbnN0IHBvcHVwQWRkQ2FyZCA9IG5ldyBQb3B1cFdpdGhGb3JtICgnLmFkZC1wb3B1cCcsIChjYXJkRGF0YSkgPT4ge1xuICBjYXJkU2VjdGlvbi5hZGRJdGVtKG1ha2VOZXdDYXJkKGNhcmREYXRhKSk7XG59KTtcbnBvcHVwQWRkQ2FyZC5zZXRFdmVudExpc3RlbmVycygpO1xuY29uc3QgY2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uT2JqZWN0LCBwb3B1cEFkZENhcmQuX2lucHV0Rm9ybSk7XG5jYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtICgnLnByb2ZpbGUtcG9wdXAnLCAoe25hbWUsIGJpb30pID0+IHtcbiAgdXNlckluZm8uc2V0VXNlckluZm8oe25hbWUsIGJpb30pO1xufSlcbnByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuY29uc3QgcHJvZmlsZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uT2JqZWN0LCBwcm9maWxlUG9wdXAuX2lucHV0Rm9ybSk7XG5wcm9maWxlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmZ1bmN0aW9uIG9wZW5DYXJkUG9wdXAgKCkge1xuICBjYXJkRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gIHBvcHVwQWRkQ2FyZC5vcGVuUG9wdXAoKTtcbn1cblxuZnVuY3Rpb24gb3BlblByb2ZpbGVQb3B1cCAoKSB7XG4gIGNvbnN0IHVzZXJJbmZvT2JqZWN0ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZVBvcHVwLnNldElucHV0VmFsdWVzKHVzZXJJbmZvT2JqZWN0KTtcbiAgcHJvZmlsZVBvcHVwLm9wZW5Qb3B1cCgpO1xuICBwcm9maWxlRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbn1cblxuLy8g0KTRg9C90LrRhtC40Y8g0YHQvtC30LTQsNC90LjRjyDQutCw0YDRgtC+0YfQutC4XG5mdW5jdGlvbiBtYWtlTmV3Q2FyZCAoe25hbWUsIHVybH0pIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtuYW1lLCB1cmx9LCAnLnRlbXBsYXRlJywgcG9wdXBXaXRoSW1hZ2Uub3BlblBvcHVwLmJpbmQocG9wdXBXaXRoSW1hZ2UpKTtcbiAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG59XG5cbmNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24gKFxuICB7XG4gICBpdGVtczogaW5pdGlhbENhcmRzLFxuICAgcmVuZGVyZXI6IGl0ZW0gPT4gY2FyZFNlY3Rpb24uYWRkSXRlbShtYWtlTmV3Q2FyZChpdGVtKSlcbiB9LFxuICAnLmVsZW1lbnRzJ1xuKTtcbmNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG5cbi8vINCe0LHRgNCw0LHQvtGC0YfQuNC60LhcbnByb2ZpbGVBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvcGVuQ2FyZFBvcHVwKTtcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3BlblByb2ZpbGVQb3B1cCk7XG5cbnBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHtuYW1lU2VsZWN0b3IsIGJpb1NlbGVjdG9yfSkge1xuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fYmlvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihiaW9TZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbyAoKSB7XG4gICAgY29uc3QgdXNlckluZm8gPSB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxuICAgICAgYmlvOiB0aGlzLl9iaW8udGV4dENvbnRlbnRcbiAgICB9O1xuICAgIHJldHVybiB1c2VySW5mbztcbiAgfVxuXG4gIHNldFVzZXJJbmZvICh7bmFtZSwgYmlvfSkge1xuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2Jpby50ZXh0Q29udGVudCA9IGJpbztcbiAgfVxufVxuIl0sIm5hbWVzIjpbInZhbGlkYXRpb25PYmplY3QiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInByb2ZpbGVFZGl0QnV0dG9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicHJvZmlsZUFkZEJ1dHRvbiIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJ0aGlzIiwiX2l0ZW1zIiwiX2NvbnRhaW5lciIsIl9yZW5kZXJlciIsImZvckVhY2giLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJDYXJkIiwiY29uZmlnIiwidGVtcGxhdGUiLCJoYW5kbGVDYXJkQ2xpY2siLCJfbmFtZSIsIm5hbWUiLCJfdXJsIiwidXJsIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9lbGVtZW50IiwicmVtb3ZlIiwiX2xpa2VCdXR0b24iLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJfZWxlbWVudEltYWdlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9kZWxldGVDYXJkIiwiX2hhbmRsZUxpa2VDYXJkIiwiX2dldFRlbXBsYXRlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJGb3JtVmFsaWRhdG9yIiwiZm9ybUVsZW1lbnQiLCJfdmFsaWRhdGlvbk9iamVjdCIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwic29tZSIsImZvcm1JbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJlcnJvck1lc3NhZ2UiLCJmb3JtRXJyb3IiLCJpZCIsImFkZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJfZW5hYmxlQnV0dG9uIiwiX2J1dHRvbkVsZW1lbnQiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfdG9nZ2xlSW5wdXRFcnJvciIsImRpc2FibGVkIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJpbnB1dCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfaGFuZGxlS2V5ZG93bkV2ZW50IiwiYmluZCIsImtleSIsImNsb3NlUG9wdXAiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhJbWFnZSIsIl9lbGVtZW50Q2FwdGlvbiIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRGb3JtIiwiaW5wdXRWYWx1ZXMiLCJ2YWx1ZSIsIl9nZXRJbnB1dFZhbHVlcyIsInJlc2V0IiwidXNlckluZm8iLCJVc2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImJpb1NlbGVjdG9yIiwiX2JpbyIsImJpbyIsInBvcHVwV2l0aEltYWdlIiwicG9wdXBBZGRDYXJkIiwiY2FyZERhdGEiLCJjYXJkU2VjdGlvbiIsImFkZEl0ZW0iLCJtYWtlTmV3Q2FyZCIsInNldEV2ZW50TGlzdGVuZXJzIiwiY2FyZEZvcm1WYWxpZGF0b3IiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJvZmlsZVBvcHVwIiwic2V0VXNlckluZm8iLCJwcm9maWxlRm9ybVZhbGlkYXRvciIsIm9wZW5Qb3B1cCIsImdlbmVyYXRlQ2FyZCIsInJlbmRlckl0ZW1zIiwidXNlckluZm9PYmplY3QiLCJnZXRVc2VySW5mbyIsInNldElucHV0VmFsdWVzIiwicmVzZXRWYWxpZGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==